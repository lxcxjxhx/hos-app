{"ast":null,"code":"import React,{useState}from'react';import axios from'axios';import{ToastContainer,toast}from'react-toastify';import'react-toastify/dist/ReactToastify.css';import{useTranslation}from'react-i18next';import'./i18n';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Register=()=>{const{t}=useTranslation();const[formData,setFormData]=useState({phone_number:'',username:'',password:'',gender:'',email:'',birth_date:'',role:'user'});const[isLoading,setIsLoading]=useState(false);const handleChange=e=>{setFormData({...formData,[e.target.name]:e.target.value});};const handleSubmit=async e=>{e.preventDefault();if(formData.password.length<8){toast.error(t('password_too_short'));return;}setIsLoading(true);try{const response=await axios.post('/api/auth/register',formData);localStorage.setItem('token',response.data.token);toast.success(t('register_success'));setTimeout(()=>{window.location.href='/dashboard';},2000);}catch(err){var _err$response,_err$response$data;toast.error(((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.message)||t('register_failed'));}finally{setIsLoading(false);}};return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-100 flex items-center justify-center p-4\",children:[/*#__PURE__*/_jsx(ToastContainer,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-md w-full bg-white rounded-lg shadow-lg p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-800 mb-6\",children:t('register')}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"phone_number\",placeholder:t('phone_number'),value:formData.phone_number,onChange:handleChange,className:\"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500\",required:true})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"username\",placeholder:t('username'),value:formData.username,onChange:handleChange,className:\"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500\",required:true})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",placeholder:t('password'),value:formData.password,onChange:handleChange,className:\"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500\",required:true})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"select\",{name:\"gender\",value:formData.gender,onChange:handleChange,className:\"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:t('select_gender')}),/*#__PURE__*/_jsx(\"option\",{value:\"\\u7537\",children:t('male')}),/*#__PURE__*/_jsx(\"option\",{value:\"\\u5973\",children:t('female')}),/*#__PURE__*/_jsx(\"option\",{value:\"\\u5176\\u4ED6\",children:t('other')})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",placeholder:t('email'),value:formData.email,onChange:handleChange,className:\"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"birth_date\",value:formData.birth_date,onChange:handleChange,className:\"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"select\",{name:\"role\",value:formData.role,onChange:handleChange,className:\"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"user\",children:t('user')}),/*#__PURE__*/_jsx(\"option\",{value:\"admin\",children:t('admin')})]})}),/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",className:\"w-full py-2 bg-blue-500 text-white rounded hover:bg-blue-600 flex items-center justify-center\",disabled:isLoading,children:[isLoading?/*#__PURE__*/_jsxs(\"svg\",{className:\"animate-spin h-5 w-5 mr-2\",viewBox:\"0 0 24 24\",children:[/*#__PURE__*/_jsx(\"circle\",{className:\"opacity-25\",cx:\"12\",cy:\"12\",r:\"10\",stroke:\"currentColor\",strokeWidth:\"4\"}),/*#__PURE__*/_jsx(\"path\",{className:\"opacity-75\",fill:\"currentColor\",d:\"M4 12a8 8 0 018-8v8H4z\"})]}):null,t('register_button')]})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"mt-4 text-center\",children:[t('have_account'),\" \",/*#__PURE__*/_jsx(\"a\",{href:\"/login\",className:\"text-blue-500 hover:underline\",children:t('login')})]})]})]});};export default Register;","map":{"version":3,"names":["React","useState","axios","ToastContainer","toast","useTranslation","jsx","_jsx","jsxs","_jsxs","Register","t","formData","setFormData","phone_number","username","password","gender","email","birth_date","role","isLoading","setIsLoading","handleChange","e","target","name","value","handleSubmit","preventDefault","length","error","response","post","localStorage","setItem","data","token","success","setTimeout","window","location","href","err","_err$response","_err$response$data","message","className","children","onSubmit","type","placeholder","onChange","required","disabled","viewBox","cx","cy","r","stroke","strokeWidth","fill","d"],"sources":["/root/travel-app/frontend/src/Register.js"],"sourcesContent":["import React, { useState } from 'react';\nimport axios from 'axios';\nimport { ToastContainer, toast } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.css';\nimport { useTranslation } from 'react-i18next';\nimport './i18n';\n\nconst Register = () => {\n  const { t } = useTranslation();\n  const [formData, setFormData] = useState({\n    phone_number: '',\n    username: '',\n    password: '',\n    gender: '',\n    email: '',\n    birth_date: '',\n    role: 'user'\n  });\n  const [isLoading, setIsLoading] = useState(false);\n\n  const handleChange = (e) => {\n    setFormData({ ...formData, [e.target.name]: e.target.value });\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    if (formData.password.length < 8) {\n      toast.error(t('password_too_short'));\n      return;\n    }\n    setIsLoading(true);\n    try {\n      const response = await axios.post('/api/auth/register', formData);\n      localStorage.setItem('token', response.data.token);\n      toast.success(t('register_success'));\n      setTimeout(() => {\n        window.location.href = '/dashboard';\n      }, 2000);\n    } catch (err) {\n      toast.error(err.response?.data?.message || t('register_failed'));\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 flex items-center justify-center p-4\">\n      <ToastContainer />\n      <div className=\"max-w-md w-full bg-white rounded-lg shadow-lg p-6\">\n        <h2 className=\"text-2xl font-bold text-gray-800 mb-6\">{t('register')}</h2>\n        <form onSubmit={handleSubmit} className=\"space-y-4\">\n          <div>\n            <input\n              type=\"text\"\n              name=\"phone_number\"\n              placeholder={t('phone_number')}\n              value={formData.phone_number}\n              onChange={handleChange}\n              className=\"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              required\n            />\n          </div>\n          <div>\n            <input\n              type=\"text\"\n              name=\"username\"\n              placeholder={t('username')}\n              value={formData.username}\n              onChange={handleChange}\n              className=\"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              required\n            />\n          </div>\n          <div>\n            <input\n              type=\"password\"\n              name=\"password\"\n              placeholder={t('password')}\n              value={formData.password}\n              onChange={handleChange}\n              className=\"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\n              required\n            />\n          </div>\n          <div>\n            <select\n              name=\"gender\"\n              value={formData.gender}\n              onChange={handleChange}\n              className=\"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <option value=\"\">{t('select_gender')}</option>\n              <option value=\"男\">{t('male')}</option>\n              <option value=\"女\">{t('female')}</option>\n              <option value=\"其他\">{t('other')}</option>\n            </select>\n          </div>\n          <div>\n            <input\n              type=\"email\"\n              name=\"email\"\n              placeholder={t('email')}\n              value={formData.email}\n              onChange={handleChange}\n              className=\"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            />\n          </div>\n          <div>\n            <input\n              type=\"date\"\n              name=\"birth_date\"\n              value={formData.birth_date}\n              onChange={handleChange}\n              className=\"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            />\n          </div>\n          <div>\n            <select\n              name=\"role\"\n              value={formData.role}\n              onChange={handleChange}\n              className=\"w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-blue-500\"\n            >\n              <option value=\"user\">{t('user')}</option>\n              <option value=\"admin\">{t('admin')}</option>\n            </select>\n          </div>\n          <button\n            type=\"submit\"\n            className=\"w-full py-2 bg-blue-500 text-white rounded hover:bg-blue-600 flex items-center justify-center\"\n            disabled={isLoading}\n          >\n            {isLoading ? (\n              <svg className=\"animate-spin h-5 w-5 mr-2\" viewBox=\"0 0 24 24\">\n                <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" />\n                <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8v8H4z\" />\n              </svg>\n            ) : null}\n            {t('register_button')}\n          </button>\n        </form>\n        <p className=\"mt-4 text-center\">\n          {t('have_account')} <a href=\"/login\" className=\"text-blue-500 hover:underline\">{t('login')}</a>\n        </p>\n      </div>\n    </div>\n  );\n};\n\nexport default Register;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}